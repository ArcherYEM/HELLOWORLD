<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.core.tjoeun.mnHome.diary.sql.DiaryMapper">

	<insert id="insertDiary" parameterType="map">
		INSERT INTO diary(
			userNickname
			,title
			,content
			,del_yn
			,openScope
		 ) VALUES (
			#{userNickname}
		    ,#{title}
		    ,#{content}
		    ,'n'
		    ,#{openScope}
	     )
	</insert>
	
	<select id="selectDiary" resultType="map" parameterType="map">
	    SELECT
	        userNickname,
	        title,
	        content,
	        update_date,
	        del_yn,
	        openScope
	    FROM 
	        diary
	    WHERE
	        1=1
	    <if test="del_yn != null">
	        AND del_yn = #{del_yn}
	    </if>
	    <if test="openScope != null">
	        <!-- 추후에는 #{openScope} 로 바꿔서 경우 처리해야함 -->
	        AND openScope = #{openScope}
	    </if>
	    <if test="userNickname != null">
	        AND userNickname = #{userNickname} 
	    </if>
	    ORDER BY create_date DESC
	</select>

	<update id="deleteDiary" parameterType="java.util.List">
		update 
			notice
		set
			del_yn = 'Y'
		where seq in
		<foreach collection="list" item="seq" open="(" close=")" separator=",">
			#{seq}
		</foreach>
	</update>
	
	<update id="modifyDiary" parameterType="map">
		update
			notice
		set
			title = #{title}
			,content = #{content}
			,update_date = current_timestamp
			
		where
			seq = #{seq}
	</update>

</mapper>